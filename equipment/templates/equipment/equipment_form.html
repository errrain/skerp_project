
{% extends 'base.html' %}
{% load widget_tweaks %}

{% block content %}
<h4>ì„¤ë¹„ì •ë³´ ë“±ë¡</h4>

<form method="post" enctype="multipart/form-data" novalidate>
    {% csrf_token %}
    <div class="row mb-2">
        <div class="col-md-6">
            <label class="form-label">ì„¤ë¹„ëª…</label>
            {{ form.name|add_class:"form-control form-control-sm" }}
        </div>
        <div class="col-md-6">
            <label class="form-label">ì„¤ë¹„ê·œê²©</label>
            {{ form.spec|add_class:"form-control form-control-sm" }}
        </div>
    </div>
    <div class="row mb-2">
        <div class="col-md-6">
            <label class="form-label">êµ¬ì…ì¼ì</label>
            {{ form.purchase_date }}
        </div>
        <div class="col-md-6">
            <label class="form-label">êµ¬ì…ì²˜</label>
            {{ form.vendor|add_class:"form-select form-select-sm" }}
        </div>
    </div>
    <div class="row mb-2">
        <div class="col-md-12">
            <label class="form-label">ì„¤ë¹„ì„¤ëª…</label>
            {{ form.description }}
        </div>
    </div>
    <div class="row mb-3">
        <div class="col-md-6">
            <label class="form-label">ì„¤ë¹„ì‚¬ì§„</label>
            {{ form.image }}
            {% if form.instance.image %}
                <div class="mt-2">
                    <img src="{{ form.instance.image.url }}" width="150" height="150" style="object-fit: cover;">
                </div>
            {% endif %}
        </div>
    </div>
    <button type="submit" name="save_equipment" class="btn btn-success btn-sm">ì €ì¥</button>
    <a href="{% url 'equipment:equipment_list' %}" class="btn btn-secondary btn-sm">â† ëª©ë¡</a>
</form>

<hr class="mt-5 mb-3">
<h5 class="fw-bold">ğŸ“Œ ì´ë ¥ê´€ë¦¬</h5>

<!-- ì´ë ¥ ëª©ë¡ + ì¸ë¼ì¸ ìˆ˜ì •/ì‚­ì œ -->
<table class="table table-sm table-bordered align-middle text-center" style="font-size: 13px;">
    <thead class="table-light">
        <tr>
            <th style="width: 150px;">ì‘ì„±ì¼ì‹œ</th>
            <th>ì´ë ¥ë‚´ìš©</th>
            <th style="width: 120px;">ì‘ì„±ì</th>
            <th style="width: 120px;">ì‘ì—…</th>
        </tr>
    </thead>
    <tbody>
        {% for history in histories %}
        <tr>
            <td>{{ history.created_at|date:"Y-m-d H:i" }}</td>
            <form method="post">
                {% csrf_token %}
                <input type="hidden" name="history_id" value="{{ history.id }}">
                <td>
                    <input type="text" name="content" value="{{ history.content }}"
                        class="form-control form-control-sm text-start">
                </td>
                <td>{{ history.created_by }}</td>
                <td>
                    <button type="submit" name="update_history" class="btn btn-outline-primary btn-sm">ìˆ˜ì •</button>
                    <button type="submit" name="delete_history" class="btn btn-outline-danger btn-sm"
                        onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">ì‚­ì œ</button>
                </td>
            </form>
        </tr>
        {% empty %}
        <tr><td colspan="4" class="text-muted">ë“±ë¡ëœ ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>
        {% endfor %}
    </tbody>
</table>

<!-- ì‹ ê·œ ì´ë ¥ ì…ë ¥í¼ -->
<form method="post" class="mt-3">
    {% csrf_token %}
    <div class="row g-2 align-items-center">
        <div class="col-md-8">
            {{ history_form.content|add_class:"form-control form-control-sm" }}
        </div>
        <div class="col-md-4">
            <button type="submit" name="save_history" class="btn btn-outline-success btn-sm">[ + ] ì´ë ¥ ë“±ë¡</button>
        </div>
    </div>
</form>
{% endblock %}
